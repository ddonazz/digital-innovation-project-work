\documentclass[a4paper]{book}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[italian]{babel}

\usepackage{geometry}
\geometry{
 a4paper,
 total={170mm,257mm},
 left=20mm,
 top=20mm,
}

\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{csquotes}

\usepackage[hidelinks]{hyperref}
\hypersetup{
    pdftitle={Studio e Implementazione di un Gateway API con Spring Cloud in Architetture a Microservizi},
    pdfauthor={Andrea Donadello},
    pdfkeywords={API Gateway, Spring Cloud, Microservizi, Architetture}
    colorlinks=true,
    linkcolor=blue,
    urlcolor=blue,
    citecolor=blue,
}

\usepackage{listings}
\usepackage{xcolor}
\usepackage{pgfplots}
\usepackage{biblatex}
\usepackage{lmodern}
\usepackage{float}
\usepackage{enumitem}
\usepackage{array}
\usepackage{booktabs}
\usepackage{caption}  
\usepackage{xurl}
\usepackage{amsmath} 
\usepackage{tabularx}
\usepackage{ragged2e}  
\usepackage{textcomp} 
\usepackage{microtype}
\usepackage{adjustbox} 

\title{Studio e Implementazione di un Gateway API con Spring Cloud in Architetture a Microservizi}
\author{Andrea Donadello} 

\renewcommand{\lstlistlistingname}{Indice del codice}

\widowpenalty=10000
\clubpenalty=10000

\captionsetup{justification=centering, font=small, labelfont=bf}

\pgfplotsset{compat=1.18}

\setlist{itemsep=0pt, topsep=0.5ex}

\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codegreen}{rgb}{0,0.5,0}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{codeblue}{rgb}{0.0,0.2,0.65}
\definecolor{codeorange}{rgb}{0.9,0.3,0}
\definecolor{codekey}{rgb}{0.1,0.1,0.7} 
\definecolor{codestring}{rgb}{0.8,0.2,0.2} 
\definecolor{codecomment}{rgb}{0.45,0.45,0.45}\itshape
\definecolor{codeannotation}{rgb}{0.4,0.4,0.4}
\definecolor{backcolour}{rgb}{0.97,0.97,0.97}
\definecolor{linecolor}{rgb}{0.8,0.8,0.8} 

\lstset{
  basicstyle=\ttfamily\small, 
  breaklines=true,
  breakatwhitespace=true,  
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
}

\lstdefinestyle{BaseStyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codecomment},
    stringstyle=\color{codestring},
    numberstyle=\tiny\color{codegray},
    basicstyle=\ttfamily\footnotesize,
    breaklines=true,
    captionpos=b,
    frame=single,
    rulecolor=\color{linecolor},
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    columns=fullflexible,
    title=\lstname,
    postbreak=\mbox{\textcolor{red}{$\hookleftarrow$}\space},
    escapeinside={\%*}{*)}
}

\lstdefinelanguage{Java}{
    keywords=[1]{ 
        abstract, continue, for, new, switch, assert, default, goto, package, synchronized,
        boolean, do, if, private, this, break, double, implements, protected, throw,
        byte, else, import, public, throws, case, enum, instanceof, return, transient,
        catch, extends, int, short, try, char, final, interface, static, void,
        class, finally, long, strictfp, volatile, const, float, native, super, while,
        var, record, yield, sealed, non-sealed, permits
    },
    keywordstyle=[1]\color{codeblue}\bfseries,
    keywords=[2]{ 
        true, false, null,
        String, Integer, Double, Boolean, Character, Byte, Short, Long, Float, Object, Void,
        List, ArrayList, Map, HashMap, Set, HashSet, Exception, System, Math,
        Optional, Stream, Runnable, Thread, Class, StringBuilder, StringBuffer
    },
    keywordstyle=[2]\color{codepurple},
    keywords=[3]{ 
        @Override, @Deprecated, @SuppressWarnings, @FunctionalInterface, @SafeVarargs,
        @NonNull, @Nullable, @PostConstruct, @PreDestroy, @Entity, @Table, @Id, @Column,
        @Autowired, @Component, @Service, @Repository, @Controller, @RestController,
        @GetMapping, @PostMapping, @PutMapping, @DeleteMapping, @RequestMapping,
        @Data
    },
    keywordstyle=[3]\color{codeannotation},
    sensitive=true,
    comment=[l]{//},
    morecomment=[s]{/*}{*/},
    morecomment=[s][\color{codegreen!80!black}]{/**}{*/}, % Javadoc
    string=[b]{"},
    morestring=[b]{'}
}

\lstdefinestyle{JavaStyle}{
    style=BaseStyle,
    language=Java,
    literate={->}{{$\rightarrow$}}2 {<-}{{$\leftarrow$}}2
}

\lstdefinelanguage{YAML}{
  keywords=[1]{true, false, null, on, off, yes, no},
  keywordstyle=[1]\color{codeblue},
  identifierstyle=\color{codekey},
  sensitive=false,
  comment=[l]{\#},
  morestring=[b]',
  morestring=[b]",
  literate=
    {>}{{\textcolor{codepurple}>}}1
    {|}{{\textcolor{codepurple}|}}1
    {-}{{{\color{codepurple}-}}}1
    {?}{{{\color{codepurple}?}}}1
    {:}{{{:}}}0,
}

\lstdefinestyle{YAMLStyle}{
    style=BaseStyle,
    language=YAML
}

\lstdefinelanguage{bash}{
    keywords={
        if, then, else, fi, for, in, do, done, while, case, esac, function,
        select, until, echo, exit, return, test, read, unset, export
    },
    keywordstyle=\color{codeblue}\bfseries,
    keywords=[2]{
        ls, cd, pwd, cp, mv, rm, mkdir, rmdir, touch, cat, grep, find,
        sed, awk, tar, gzip, gunzip, chmod, chown, sudo, su, man,
        git, docker, kubectl, java, mvn, gradle, npm, node, python
    },
    keywordstyle=[2]\color{codepurple},
    sensitive=false,
    comment=[l]{\#},
    morestring=[b]",
    morestring=[b]',
    morestring=[s][\color{codestring}]{`}{`} 
}

\lstdefinestyle{BashStyle}{
    style=BaseStyle,
    language=bash,
    identifierstyle=\color{black},
    alsoletter={-,$},
    literate=
      {\\$}{{\textcolor{codepurple}{\$}}}1
      {--}{{\textcolor{codeorange}{--}}}2
      {-}{{\textcolor{codeorange}{-}}}1
      {~}{{\raise.5ex\hbox{\texttildelow}}}1
}

\newenvironment{abstract}%
  {\clearpage\null\vfill\begin{center}%
    \bfseries\abstractname\end{center}}%
  {\vfill\null}
  
\addbibresource{references.bib}

\begin{document}

    \pagestyle{plain}
    \maketitle

    \input{chapters/abstract}

    \tableofcontents

    \listoftables 

    \lstlistoflistings

    \chapter{Introduzione}
    \input{chapters/introduction}

    \chapter[Concetti Fondamentali]{Concetti Fondamentali dei Gateway API}
    \input{chapters/chapter2}

    \chapter[Spring Cloud Gateway]{Spring Cloud Gateway: Caratteristiche e Architettura}
    \input{chapters/chapter3}

    \chapter[Vantaggi e Casi d'Uso]{Vantaggi e Casi d'Uso di Spring Cloud Gateway}
    \input{chapters/chapter4}

    \chapter[Implementazione Pratica]{Implementazione Pratica: Il Progetto API Gateway}
    \input{chapters/chapter5}

    \chapter[Analisi e Limitazioni]{Analisi Critica e Limitazioni}
    \input{chapters/chapter6}

    \chapter{Conclusioni e Sviluppi Futuri}
    \input{chapters/chapter7}

\end{document}